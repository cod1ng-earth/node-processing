#!/usr/bin/env node
require('dotenv').config()

const kafka = require('../lib/kafka');

const prefix = process.env.CLOUDKARAFKA_TOPIC_PREFIX;
const topic = `${prefix}test`;

const producer = kafka.producer()

const run = async() => {
    const dt = new Date()
    await producer.connect()
    const res = await producer.send({
      topic,
      //compression: CompressionTypes.GZIP,
      messages: [
          {value: dt.toISOString()}
      ]
    });
    console.log(res)
    await producer.disconnect()
}

run();
